<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="myPetitionsMapper">


	<resultMap type="Petition" id="myPetitions_rm">
	
	
		<id property="petitionNo" column="PT_NO" />

		<result property="petitionTitle" column="PT_TITLE" />
		<result property="petitionContent" column="PT_CONTENT" />
		<result property="petitionDelFl" column="PT_DEL_FL" />
		
		<result property="userNo" column="USER_NO" />

		<result property="petitionLikeNo" column="PT_LIKE_NO" />
		<result property="petitionLikeCount" column="PT_LIKE_COUNT" />
	
	
	</resultMap>

	<!-- 작성한 글 목록 조회 -->
	<select id="selectMyPetitions" resultMap="myPetitions_rm">
	SELECT PT_NO, PT_TITLE, PT_CONTENT,	
		(SELECT COUNT(*)
		FROM "PETITION_LIKE" SUB
		WHERE SUB.PT_NO = MAIN.PT_NO) PT_LIKE_COUNT
	FROM "PETITION" MAIN
	WHERE PT_DEL_FL = 'N'
	AND USER_NO = #{UserNo}
	</select>
	
	<!-- 좋아요 한 글 목록 조회 -->
	<select id="selectLikePetition" resultMap="myPetitions_rm">
	SELECT PT_NO, PT_TITLE, PT_CONTENT, USER_NO 
	FROM "PETITION"
	WHERE PT_NO IN (SELECT PT_NO FROM "PETITION_LIKE" WHERE "USER_NO" = #{userNos})
	</select>
	
	
	
	
</mapper>